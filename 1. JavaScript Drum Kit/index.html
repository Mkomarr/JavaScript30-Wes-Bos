<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Drum kit</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
 <h1>Let's play drums! :~)</h1>
    <div class="keys">
        <div class="key 65" data-key="65">
            <span class="sound A">A <br/>clap</span>
        </div>
        <div class="key 83" data-key="83">
            <span class="sound S">S <br/>hihat</span>
        </div>
        <div class="key 68" data-key="68">
            <span class="sound D">D <br/>kick</span>
        </div>
        <div class="key 70" data-key="70">
            <span class="sound F">F <br/>openhat</span>
        </div>
        <div class="key 71" data-key="71">
            <span class="sound G">G <br/>boom</span>
        </div>
        <div class="key 72" data-key="72">
            <span class="sound H">H <br/>ride</span>
        </div>
        <div class="key 74" data-key="74">
            <span class="sound J">J <br/>snare</span>
        </div>
        <div class="key 75" data-key="75">
            <span class="sound K">K <br/>tom</span>
        </div>
        <div class="key 76" data-key="76">
            <span class="sound L">L <br/>tink</span>
        </div>
    </div>
    <audio data-key="65" src="sounds/clap.mp3"></audio>
    <audio data-key="83" src="sounds/hihat.mp3"></audio>
    <audio data-key="68" src="sounds/kick.mp3"></audio>
    <audio data-key="70" src="sounds/openhat.mp3"></audio>
    <audio data-key="71" src="sounds/boom.mp3"></audio>
    <audio data-key="72" src="sounds/ride.mp3"></audio>
    <audio data-key="74" src="sounds/snare.mp3"></audio>
    <audio data-key="75" src="sounds/tom.mp3"></audio>
    <audio data-key="76" src="sounds/tink.mp3"></audio>

<script>
//keydown and play
    function playSound(e) {
        const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);
        const key = document.querySelector(`.key[data-key="${e.keyCode}"]`);
        if(!audio) return;
        audio.currentTime = 0; //rewind to the start
        audio.play();
        key.classList.add('playing');
    }

//click and play
function clickAndPlay(e) {
    // const key = document.querySelector(`.key[data-key="${e.target.className}"]`);
    if(e.target.className === 'key 65' || e.target.className === 'sound A') {
        const audio = document.querySelector('audio[data-key="65"]');
        audio.currentTime = 0
        audio.play();
        document.querySelector('.key[data-key="65"]').classList.add('playing');
    } else if (e.target.className === 'key 83' || e.target.className === 'sound S') {
        const audio = document.querySelector('audio[data-key="83"]');
        audio.currentTime = 0
        audio.play();
        document.querySelector('.key[data-key="83"]').classList.add('playing');
    } else if (e.target.className === 'key 68' || e.target.className === 'sound D') {
        const audio = document.querySelector('audio[data-key="68"]');
        audio.currentTime = 0
        audio.play();
        document.querySelector('.key[data-key="68"]').classList.add('playing');
    } else if (e.target.className === 'key 70' || e.target.className === 'sound F') {
        const audio = document.querySelector('audio[data-key="70"]');
        audio.currentTime = 0
        audio.play();
        document.querySelector('.key[data-key="70"]').classList.add('playing');
    } else if (e.target.className === 'key 71' || e.target.className === 'sound G') {
        const audio = document.querySelector('audio[data-key="71"]');
        audio.currentTime = 0
        audio.play();
        document.querySelector('.key[data-key="71"]').classList.add('playing');
    } else if (e.target.className === 'key 72' || e.target.className === 'sound H') {
        const audio = document.querySelector('audio[data-key="72"]');
        audio.currentTime = 0
        audio.play();
        document.querySelector('.key[data-key="72"]').classList.add('playing');
    } else if (e.target.className === 'key 74' || e.target.className === 'sound J') {
        const audio = document.querySelector('audio[data-key="74"]');
        audio.currentTime = 0
        audio.play();
        document.querySelector('.key[data-key="74"]').classList.add('playing');
    } else if (e.target.className === 'key 75' || e.target.className === 'sound K') {
        const audio = document.querySelector('audio[data-key="75"]');
        audio.currentTime = 0
        audio.play();
        document.querySelector('.key[data-key="75"]').classList.add('playing');
    } else if (e.target.className === 'key 76' || e.target.className === 'sound L') {
        const audio = document.querySelector('audio[data-key="76"]');
        audio.currentTime = 0
        audio.play();
        document.querySelector('.key[data-key="76"]').classList.add('playing');
    } else {
        return;
    }
}

//add visualisation
    function removeTransition(e) {
        if(e.propertyName !== 'transform') return; //skip it if it's not a transform
        this.classList.remove('playing');
        // console.log(e.propertyName);
    }


const keys = document.querySelectorAll('.key');
keys.forEach(key => key.addEventListener('transitionend', removeTransition));
window.addEventListener('keydown', playSound);
window.addEventListener('click', clickAndPlay);

</script>
</body>
</html>